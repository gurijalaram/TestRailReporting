/*
 * This file was generated by the Gradle 'init' task.
 */


rootProject.name = 'build'

//Utils
//Default modules initialization
include(':utils')
include(':apibase')

project(':utils').projectDir = file('../utils')
project(':apibase').projectDir = file('../apibase')



final String[] microservicesModules = ["ats", "cds", "cis", "edc", "fms", "nts"]
final String[] webModules = ["cas", "cia", "ciconnect", "cid", "cidapp", "cir"]
final String[] myOwn = [":web:cas", ":microservices:ats"]

Map<String, String[]> buildConfigurations = new HashMap<String, String[]>() {
    {
        put("microservices", microservicesModules)
        put("web", webModules)
        put("myOwn", myOwn)
    }
}

final String configuration = System.getProperty("conf");

if (configuration != null) {
    final String[] buildModules = buildConfigurations.get(configuration);
    String includePath;
    String filePath;

    for (int i = 0; i < buildModules.length; i++) {
        final String moduleName = buildModules[i];
        println("Building module: " + moduleName)

        if(moduleName.contains(':')){
            includeProject(moduleName, ".." + moduleName.replace(':', '/'))
        } else {
            includeProject(String.format(":%s:%s", configuration, moduleName), String.format("../%s/%s", configuration, moduleName))
        }

    }
} else {

    //Microservices

    include(':microservices:ats')
    include(':microservices:cds')
    include(':microservices:cis')
    include(':microservices:edc')
    include(':microservices:fms')
    include(':microservices:nts')

    project(':microservices:ats').projectDir = file('../microservices/ats')
    project(':microservices:cds').projectDir = file('../microservices/cds')
    project(':microservices:cis').projectDir = file('../microservices/cis')
    project(':microservices:edc').projectDir = file('../microservices/edc')
    project(':microservices:fms').projectDir = file('../microservices/fms')
    project(':microservices:nts').projectDir = file('../microservices/nts')

    //Web
    include ':web:cia'
    include ':web:cid'
    include ':web:cir'
    include ':web:cidapp'
    include ':web:ciconnect'
    include ':web:cas'

    project(':web:cia').projectDir = file('../web/cia')
    project(':web:cid').projectDir = file('../web/cid')
    project(':web:cir').projectDir = file('../web/cir')
    project(':web:cidapp').projectDir = file('../web/cidapp')
    project(':web:ciconnect').projectDir = file('../web/ciconnect')
    project(':web:cas').projectDir = file('../web/cas')

    if (System.getProperty("all") != null) {
        include(':database')
        project(':database').projectDir = file('../db')
    }
}


void includeProject(final String includePath, final String filePath) {
    println("Include path: " + includePath)
    println("File path: " + filePath)
    include(includePath)
    project(includePath).projectDir = file(filePath)
}
